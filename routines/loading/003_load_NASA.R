# Load required packages
library(MDstats)
library(MD3)

# Set data directory
if (!exists("data_dir")) data_dir = getwd()

# Load NASA unconsolidated assets
la = mds("Estat/nasa_10_f_bs/A.MIO_EUR.NCO.S1+S11+S12+S121+S121_S122_S123+S122+S122_S123+S123+S124+S125+S125_S126_S127+S126+S127+S128+S128_S129+S129+S13+S14+S14_S15+S15+S2+S21+S2I.ASS.F+F1+F2+F21+F22+F29+F3+F31+F32+F4+F41+F42+F5+F51+F511+F512+F519+F52+F6+F61+F62+F63+F63_F64_F65+F64+F65+F66+F7+F8+F81+F89.")
###  if there is an error please try
### helpmds("ESTAT/nasa_10_f_bs/A.MIO_EUR.NCO.S1+S11+S12+S121+S121_S122_S123+S122+S122_S123+S123+S124+S125+S125_S126_S127+S126+S127+S128+S128_S129+S129+S13+S14+S14_S15+S15+S2+S21+S2I.ASS.F+F1+F2+F21+F22+F29+F3+F31+F32+F4+F41+F42+F5+F51+F511+F512+F519+F52+F6+F61+F62+F63+F63_F64_F65+F64+F65+F66+F7+F8+F81+F89.")
### and then again
### la= mds("Estat/nasa_10_f_bs/A.MIO_EUR.NCO.S1+S11+S12+S121+S121_S122_S123+S122+S122_S123+S123+S124+S125+S125_S126_S127+S126+S127+S128+S128_S129+S129+S13+S14+S14_S15+S15+S2+S21+S2I.ASS.F+F1+F2+F21+F22+F29+F3+F31+F32+F4+F41+F42+F5+F51+F511+F512+F519+F52+F6+F61+F62+F63+F63_F64_F65+F64+F65+F66+F7+F8+F81+F89.")

saveRDS(la, file=file.path(data_dir, 'domestic_loading_data_files/nasa_unconsolidated_stocks_assets.rds'))

# Load NASA unconsolidated flows
lat = mds("Estat/nasa_10_f_tr/A.MIO_EUR.NCO.S1+S11+S12+S121+S121_S122_S123+S122+S122_S123+S123+S124+S125+S125_S126_S127+S126+S127+S128+S128_S129+S129+S13+S14+S14_S15+S15+S2.ASS.F1+F2+F21+F22+F29+F3+F31+F32+F4+F41+F42+F5+F51+F511+F512+F519+F52+F6+F61+F62+F63+F63_F64_F65+F64+F65+F66+F7+F8+F81+F89.")
saveRDS(lat, file=file.path(data_dir, 'domestic_loading_data_files/nasa_unconsolidated_flows_assets.rds'))

# Load NASA consolidated stocks
lc = mds("Estat/nasa_10_f_bs/A.MIO_EUR.CO.S1+S11+S12+S121+S121_S122_S123+S122+S122_S123+S123+S124+S125+S125_S126_S127+S126+S127+S128+S128_S129+S129+S13+S14+S14_S15+S15+S2+S21+S2I.ASS.F+F1+F2+F21+F22+F29+F3+F31+F32+F4+F41+F42+F5+F51+F511+F512+F519+F52+F6+F61+F62+F63+F63_F64_F65+F64+F65+F66+F7+F8+F81+F89.")
saveRDS(lc, file=file.path(data_dir, 'domestic_loading_data_files/nasa_consolidated_stocks_assets.rds'))

# Load NASA consolidated flows
lct = mds("Estat/nasa_10_f_tr/A.MIO_EUR.CO.S1+S11+S12+S121+S121_S122_S123+S122+S122_S123+S123+S124+S125+S125_S126_S127+S126+S127+S128+S128_S129+S129+S13+S14+S14_S15+S15+S2.ASS.F1+F2+F21+F22+F29+F3+F31+F32+F4+F41+F42+F5+F51+F511+F512+F519+F52+F6+F61+F62+F63+F63_F64_F65+F64+F65+F66+F7+F8+F81+F89.")
saveRDS(lct, file=file.path(data_dir, 'domestic_loading_data_files/nasa_consolidated_flows_assets.rds'))

# Load NASA unconsolidated liabilities stocks
la_l = mds("Estat/nasa_10_f_bs/A.MIO_EUR.NCO.S1+S11+S11_S14_S15+S12+S121+S121_S122_S123+S122+S122_S123+S123+S124+S125+S125_S126_S127+S126+S127+S128+S128_S129+S129+S13+S14+S14_S15+S15+S2.LIAB.F+F1+F11+F2+F21+F22+F29+F3+F31+F32+F4+F41+F42+F5+F51+F511+F512+F519+F52+F6+F61+F62+F63+F63_F64_F65+F64+F65+F66+F7+F8+F81+F89.")
###  if there is an error please try
### helpmds("ESTAT/nasa_10_f_bs/A.MIO_EUR.NCO.S1+S11+S11_S14_S15+S12+S121+S121_S122_S123+S122+S122_S123+S123+S124+S125+S125_S126_S127+S126+S127+S128+S128_S129+S129+S13+S14+S14_S15+S15+S2.LIAB.F+F1+F11+F2+F21+F22+F29+F3+F31+F32+F4+F41+F42+F5+F51+F511+F512+F519+F52+F6+F61+F62+F63+F63_F64_F65+F64+F65+F66+F7+F8+F81+F89.")
### and then again
### la_l= mds("Estat/nasa_10_f_bs/A.MIO_EUR.NCO.S1+S11+S11_S14_S15+S12+S121+S121_S122_S123+S122+S122_S123+S123+S124+S125+S125_S126_S127+S126+S127+S128+S128_S129+S129+S13+S14+S14_S15+S15+S2.LIAB.F+F1+F11+F2+F21+F22+F29+F3+F31+F32+F4+F41+F42+F5+F51+F511+F512+F519+F52+F6+F61+F62+F63+F63_F64_F65+F64+F65+F66+F7+F8+F81+F89.")

saveRDS(la_l, file=file.path(data_dir, 'domestic_loading_data_files/nasa_unconsolidated_stocks_LIAB.rds'))

# Load NASA unconsolidated liabilities flows
lat_l = mds("Estat/nasa_10_f_tr/A.MIO_EUR.NCO.S1+S11+S11_S14_S15+S12+S121+S121_S122_S123+S122+S122_S123+S123+S124+S125+S125_S126_S127+S126+S127+S128+S128_S129+S129+S13+S14+S14_S15+S15+S2.LIAB.F1+F11+F2+F21+F22+F29+F3+F31+F32+F4+F41+F42+F5+F51+F511+F512+F519+F52+F6+F61+F62+F63+F63_F64_F65+F64+F65+F66+F7+F8+F81+F89.")
saveRDS(lat_l, file=file.path(data_dir, 'domestic_loading_data_files/nasa_unconsolidated_flows_LIAB.rds'))

# Load NASA consolidated liabilities stocks
lc_l = mds("Estat/nasa_10_f_bs/A.MIO_EUR.CO.S1+S11+S11_S14_S15+S12+S121+S121_S122_S123+S122+S122_S123+S123+S124+S125+S125_S126_S127+S126+S127+S128+S128_S129+S129+S13+S14+S14_S15+S15+S2.LIAB.F+F1+F11+F2+F21+F22+F29+F3+F31+F32+F4+F41+F42+F5+F51+F511+F512+F519+F52+F6+F61+F62+F63+F63_F64_F65+F64+F65+F66+F7+F8+F81+F89.")
saveRDS(lc_l, file=file.path(data_dir, 'domestic_loading_data_files/nasa_consolidated_stocks_LIAB.rds'))

# Load NASA consolidated liabilities flows
lct_l = mds("Estat/nasa_10_f_tr/A.MIO_EUR.CO.S1+S11+S11_S14_S15+S12+S121+S121_S122_S123+S122+S122_S123+S123+S124+S125+S125_S126_S127+S126+S127+S128+S128_S129+S129+S13+S14+S14_S15+S15+S2.LIAB.F1+F2+F21+F22+F29+F3+F31+F32+F4+F41+F42+F5+F51+F511+F512+F519+F52+F6+F61+F62+F63+F63_F64_F65+F64+F65+F66+F7+F8+F81+F89.")
saveRDS(lct_l, file=file.path(data_dir, 'domestic_loading_data_files/nasa_consolidated_flows_LIAB.rds'))